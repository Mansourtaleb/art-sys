<div class="container-fluid">

<div class="container mt-4 mb-5">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card">
        <div class="card-header">
          <h3 class="mb-0">
            <i class="bi bi-palette"></i> Créer une nouvelle œuvre
          </h3>
        </div>
        <div class="card-body">
          <!-- Messages -->
          <div *ngIf="error()" class="alert alert-danger alert-dismissible fade show">
            {{ error() }}
            <button type="button" class="btn-close" (click)="error.set(null)"></button>
          </div>

          <div *ngIf="success()" class="alert alert-success">
            <i class="bi bi-check-circle"></i> Œuvre créée avec succès ! Redirection...
          </div>

          <!-- Formulaire -->
          <form (ngSubmit)="onSubmit()" #oeuvreForm="ngForm">
            <!-- Titre -->
            <div class="mb-3">
              <label for="titre" class="form-label">
                Titre de l'œuvre <span class="text-danger">*</span>
              </label>
              <input type="text"
                     class="form-control"
                     id="titre"
                     [(ngModel)]="oeuvre.titre"
                     name="titre"
                     required
                     placeholder="Ex: Coucher de soleil sur la Médina">
            </div>

            <!-- Description -->
            <div class="mb-3">
              <label for="description" class="form-label">
                Description <span class="text-danger">*</span>
              </label>
              <textarea class="form-control"
                        id="description"
                        rows="4"
                        [(ngModel)]="oeuvre.description"
                        name="description"
                        required
                        placeholder="Décrivez votre œuvre, son inspiration, sa signification...">
              </textarea>
            </div>

            <!-- Prix, Stock et Catégorie -->
            <div class="row">
              <div class="col-md-4">
                <div class="mb-3">
                  <label for="prix" class="form-label">
                    Prix (DT) <span class="text-danger">*</span>
                  </label>
                  <input type="number"
                         class="form-control"
                         id="prix"
                         [(ngModel)]="oeuvre.prix"
                         name="prix"
                         required
                         min="0"
                         step="0.01">
                </div>
              </div>
              <div class="col-md-4">
                <div class="mb-3">
                  <label for="stock" class="form-label">
                    Stock disponible <span class="text-danger">*</span>
                  </label>
                  <input type="number"
                         class="form-control"
                         id="stock"
                         [(ngModel)]="oeuvre.stockDisponible"
                         name="stock"
                         required
                         min="0">
                </div>
              </div>
              <div class="col-md-4">
                <div class="mb-3">
                  <label for="categorie" class="form-label">
                    Catégorie <span class="text-danger">*</span>
                  </label>
                  <select class="form-select"
                          id="categorie"
                          [(ngModel)]="oeuvre.categorieId"
                          name="categorie"
                          required>
                    <option value="">-- Sélectionner --</option>
                    <option *ngFor="let cat of categories()" [value]="cat.id">
                      {{ cat.nom }}
                    </option>
                  </select>
                </div>
              </div>
            </div>

            <!-- Image -->
            <div class="mb-3">
              <label for="image" class="form-label">
                Image de l'œuvre
              </label>
              <input type="file"
                     class="form-control"
                     id="image"
                     (change)="onFileSelected($event)"
                     accept="image/*">
              <small class="text-muted">
                Formats acceptés: JPG, PNG, GIF (max 5MB)
              </small>

              <!-- Aperçu de l'image -->
              <div *ngIf="imagePreview()" class="mt-3">
                <img [src]="imagePreview()"
                     alt="Aperçu"
                     class="img-thumbnail"
                     style="max-height: 200px;">
              </div>
            </div>

            <!-- Techniques -->
            <div class="mb-3">
              <label for="techniques" class="form-label">
                Techniques utilisées
              </label>
              <input type="text"
                     class="form-control"
                     id="techniques"
                     [(ngModel)]="oeuvre.techniques"
                     name="techniques"
                     placeholder="Ex: Huile sur toile, Aquarelle, Photographie numérique...">
            </div>

            <!-- Dimensions -->
            <div class="row">
              <div class="col-md-4">
                <div class="mb-3">
                  <label for="largeur" class="form-label">
                    Largeur (cm)
                  </label>
                  <input type="number"
                         class="form-control"
                         id="largeur"
                         [(ngModel)]="oeuvre.dimensions.largeur"
                         name="largeur"
                         min="0">
                </div>
              </div>
              <div class="col-md-4">
                <div class="mb-3">
                  <label for="hauteur" class="form-label">
                    Hauteur (cm)
                  </label>
                  <input type="number"
                         class="form-control"
                         id="hauteur"
                         [(ngModel)]="oeuvre.dimensions.hauteur"
                         name="hauteur"
                         min="0">
                </div>
              </div>
              <div class="col-md-4">
                <div class="mb-3">
                  <label for="profondeur" class="form-label">
                    Profondeur (cm)
                  </label>
                  <input type="number"
                         class="form-control"
                         id="profondeur"
                         [(ngModel)]="oeuvre.dimensions.profondeur"
                         name="profondeur"
                         min="0">
                </div>
              </div>
            </div>

            <!-- Disponibilité -->
            <div class="form-check mb-3">
              <input type="checkbox"
                     class="form-check-input"
                     id="disponible"
                     [(ngModel)]="oeuvre.disponible"
                     name="disponible">
              <label class="form-check-label" for="disponible">
                Œuvre disponible à la vente
              </label>
            </div>

            <!-- Boutons -->
            <div class="d-flex justify-content-between">
              <button type="button"
                      class="btn btn-secondary"
                      (click)="cancel()">
                <i class="bi bi-x-circle"></i> Annuler
              </button>
              <button type="submit"
                      class="btn btn-primary"
                      [disabled]="loading() || !oeuvreForm.form.valid">
                <span *ngIf="!loading()">
                  <i class="bi bi-check-circle"></i> Créer l'œuvre
                </span>
                <span *ngIf="loading()">
                  <span class="spinner-border spinner-border-sm me-2"></span>
                  Création...
                </span>
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

  </div>



